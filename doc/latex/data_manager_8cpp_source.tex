\doxysubsection{data\+Manager.\+cpp}
\hypertarget{data_manager_8cpp_source}{}\label{data_manager_8cpp_source}\index{dataManager.cpp@{dataManager.cpp}}
\mbox{\hyperlink{data_manager_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00007}00007\ \textcolor{preprocessor}{\#include\ <filesystem>}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00008}00008\ \textcolor{preprocessor}{\#include\ <fstream>}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00010}00010\ \textcolor{preprocessor}{\#include\ <random>}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00013}00013\ \textcolor{preprocessor}{\#include\ <spdlog/spdlog.h>}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00015}00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{city_graph_8h}{cityGraph.h}}"{}}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00016}00016\ \textcolor{preprocessor}{\#include\ "{}cityMap.h"{}}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00017}00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{data_manager_8h}{dataManager.h}}"{}}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00018}00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{manager_8h}{manager.h}}"{}}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00020}\mbox{\hyperlink{class_data_manager_aabcf390e86b29a8d73379627dc846d78}{00020}}\ \mbox{\hyperlink{class_data_manager_aabcf390e86b29a8d73379627dc846d78}{DataManager::DataManager}}(std::string\ filename)\ \{}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00021}00021\ \ \ \textcolor{comment}{//\ Create\ /data\ folder\ if\ it\ doesn't\ exist}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00022}00022\ \ \ \textcolor{keywordflow}{if}\ (!std::filesystem::exists(\textcolor{stringliteral}{"{}data"{}}))\ \{}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00023}00023\ \ \ \ \ spdlog::debug(\textcolor{stringliteral}{"{}Creating\ data\ folder"{}});}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00024}00024\ \ \ \ \ std::filesystem::create\_directory(\textcolor{stringliteral}{"{}data"{}});}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00025}00025\ \ \ \}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00026}00026\ \}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00028}\mbox{\hyperlink{class_data_manager_a7b828405a4d80e14b2fb2a960fff096f}{00028}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_data_manager_a7b828405a4d80e14b2fb2a960fff096f}{DataManager::createData}}(\textcolor{keywordtype}{int}\ numData,\ \textcolor{keywordtype}{int}\ numCarsMin,\ \textcolor{keywordtype}{int}\ numCarsMax,\ std::string\ mapName)\ \{}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00029}00029\ \ \ \textcolor{comment}{//\ If\ numData\ is\ less\ than\ 1,\ default\ to\ a\ very\ high\ number\ (as\ in\ your\ original\ code).}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00030}00030\ \ \ numData\ =\ numData\ <\ 1\ ?\ INT\_MAX\ :\ numData;}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00032}00032\ \ \ \textcolor{comment}{//\ Remove\ file\ extension\ from\ mapName\ to\ construct\ the\ output\ filename.}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00033}00033\ \ \ std::string\ mapNameNoExt\ =\ mapName.substr(0,\ mapName.find\_last\_of(\textcolor{stringliteral}{"{}."{}}));}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00034}00034\ \ \ std::string\ filename\ =\ \textcolor{stringliteral}{"{}data/"{}}\ +\ mapNameNoExt\ +\ \textcolor{stringliteral}{"{}\_"{}}\ +\ std::to\_string((\textcolor{keywordtype}{int})CBS\_MAX\_SUB\_TIME)\ +}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (ROAD\_ENABLE\_RIGHT\_HAND\_TRAFFIC\ ?\ \textcolor{stringliteral}{"{}\_RHT"{}}\ :\ \textcolor{stringliteral}{"{}"{}})\ +\ \textcolor{stringliteral}{"{}\_data.csv"{}};}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00037}00037\ \ \ \textcolor{comment}{//\ Load\ the\ city\ map.}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00038}00038\ \ \ \mbox{\hyperlink{class_city_map}{CityMap}}\ cityMap;}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00039}00039\ \ \ cityMap.\mbox{\hyperlink{class_city_map_a8c3dca06befcb24a04779fa60d18cf2c}{loadFile}}(\textcolor{stringliteral}{"{}assets/map/"{}}\ +\ mapName);}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00041}00041\ \ \ \textcolor{comment}{//\ Create\ the\ city\ graph.}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00042}00042\ \ \ \mbox{\hyperlink{class_city_graph}{CityGraph}}\ cityGraph;}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00043}00043\ \ \ cityGraph.\mbox{\hyperlink{class_city_graph_ac5ce9a9b617d6da67f06c105fefef8ee}{createGraph}}(cityMap);}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00045}00045\ \ \ \textcolor{comment}{//\ Open\ the\ output\ file\ in\ append\ mode.}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00046}00046\ \ \ std::ofstream\ file;}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00047}00047\ \ \ file.open(filename,\ std::ios::app);}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00048}00048\ \ \ \textcolor{keywordflow}{if}\ (!file.is\_open())\ \{}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00049}00049\ \ \ \ \ spdlog::error(\textcolor{stringliteral}{"{}Failed\ to\ open\ file\ \{\}"{}},\ filename);}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00050}00050\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00051}00051\ \ \ \}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00053}00053\ \ \ std::mt19937\ rng(std::chrono::steady\_clock::now().time\_since\_epoch().count());}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00054}00054\ \ \ std::uniform\_int\_distribution<int>\ dist(numCarsMin,\ numCarsMax);}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00056}00056\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ numData;\ i\ +=\ 1)\ \{}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00057}00057\ \ \ \ \ \textcolor{keywordtype}{int}\ numCars\ =\ dist(rng);}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00059}00059\ \ \ \ \ \mbox{\hyperlink{class_manager}{Manager}}\ manager(cityGraph,\ cityMap,\ \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00060}00060\ \ \ \ \ \textcolor{keyword}{auto}\ resData\ =\ manager.\mbox{\hyperlink{class_manager_a59293d51b95ea69c45e88471d1ba01a9}{createCarsCBS}}(numCars);}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00061}00061\ \ \ \ \ \textcolor{keywordflow}{if}\ (!resData.first)\ \{}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00062}00062\ \ \ \ \ \ \ spdlog::warn(\textcolor{stringliteral}{"{}Data\ \{\}:\ CBS\ failed\ (numCars:\ \{\})"{}},\ i\ +\ 1,\ numCars);}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00063}00063\ \ \ \ \ \ \ i-\/-\/;}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00064}00064\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00065}00065\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00067}00067\ \ \ \ \ data\ validResData\ =\ resData.second;}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00069}00069\ \ \ \ \ file\ <<\ validResData.numCars\ <<\ \textcolor{stringliteral}{"{};"{}}\ <<\ validResData.carDensity;}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00070}00070\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ speed\ :\ validResData.carAvgSpeed)\ \{}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00071}00071\ \ \ \ \ \ \ file\ <<\ \textcolor{stringliteral}{"{};"{}}\ <<\ speed;}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00072}00072\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00073}00073\ \ \ \ \ file\ <<\ std::endl;}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00075}00075\ \ \ \ \ \textcolor{keywordflow}{if}\ (numData\ ==\ INT\_MAX)\ \{}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00076}00076\ \ \ \ \ \ \ spdlog::info(\textcolor{stringliteral}{"{}Data\ \{\}:\ numCars:\ \{\},\ carDensity:\ \{:0>6.5\}"{}},\ i\ +\ 1,\ validResData.numCars,\ validResData.carDensity);}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00077}00077\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00078}00078\ \ \ \ \ \ \ spdlog::info(\textcolor{stringliteral}{"{}Data\ \{\}:\ numCars:\ \{\},\ carDensity:\ \{:0>6.5\}"{}},\ i\ +\ 1,\ numData,\ validResData.numCars,}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validResData.carDensity);}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00080}00080\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00081}00081\ \ \ \}}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00083}00083\ \ \ file.close();}
\DoxyCodeLine{\Hypertarget{data_manager_8cpp_source_l00084}00084\ \}}

\end{DoxyCode}
